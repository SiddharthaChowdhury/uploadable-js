function $Incoming(e){this.drop_cont=document.querySelector(e.dropAreaID),this.uploadSuccess=e.uploadSuccess||function(e){console.log("default response",e)},this.uploadURL=e.uploadURL,this.fileTypes=e.fileTypes,this.dropZone=null,this.progCont=null,this.filelist=[],this._init()}$Incoming.prototype._init=function(){this.drop_cont.setAttribute("style","position: relative;");var e=this,t=document.createElement("div");t.setAttribute("class","si_droparea"),t.setAttribute("style","position: absolute;"),t.addEventListener("dragover",function(e){e.preventDefault()}),t.addEventListener("drop",function(t){t.preventDefault();var n=t.dataTransfer.files;e._processFiles(n)});var n=document.createElement("div");n.setAttribute("style","padding:15px; font-size:0.9em; margin-bottom:15px;"),n.innerHTML="Drag and Drop your images below or simply ";var r=document.createElement("div");r.setAttribute("style","padding:10px 20px;");var o=document.createElement("input");o.setAttribute("type","file"),o.setAttribute("id","chooseFiles"),o.setAttribute("multiple",!0),o.setAttribute("style","display: none;"),o.addEventListener("change",function(t){var n=t.target.files;e._processFiles(n)});var i=document.createElement("a");i.innerHTML="Choose Files!",i.setAttribute("class","si_chooseFiles"),i.addEventListener("click",function(){o.click()}),n.appendChild(i),n.appendChild(o);var a=document.createElement("a");a.innerHTML="&#10006;",a.setAttribute("class","si_closeUpload"),a.setAttribute("style","position: absolute; cursor:pointer; right: 10px; top: 10px; font-size: 17px; text-decoration: none; color: #fff; border-radius: 50%; border: 2px solid #fff; padding: 5px 10px;"),a.addEventListener("click",function(e){t.style.display="none"}),t.appendChild(n),t.appendChild(a),t.appendChild(r),e.drop_cont.appendChild(t),e.dropZone=t,e.progCont=r},$Incoming.prototype._processFiles=function(e){function t(e,t){var l=new FormData;l.append("file",t);var s=n(t),p=new XMLHttpRequest;p.upload.addEventListener("progress",function(e){return function(t){r(t,e)}}(s),!1),p.addEventListener("load",function(e){return function(t){o(t,e)}}(s),!1),p.addEventListener("error",function(e){return function(t){i(t,e)}}(s),!1),p.addEventListener("abort",function(e){return function(t){a(t,e)}}(s),!1),p.open("POST",d.uploadURL),p.send(l)}function n(e){for(var t=e.size,n=new Array("Bytes","KB","MB","GB"),r=0;t>900;)t/=1024,r++;var o=Math.round(100*t)/100+" "+n[r],i=document.createElement("div");i.setAttribute("style","position:relative; padding:10px; width:200px; font-size:0.7em; display:inline-block; margin:10px 10px 0px 0px;");var a=document.createElement("div"),l=document.createElement("a");l.setAttribute("style","text-decoration:none; "),l.innerHTML=e.name.length>20?e.name.substring(0,20)+"... ("+o+")":e.name+" ("+o+")";var s=document.createElement("a");s.setAttribute("style","cursor:pointer; color:silver; text-decoration:none; margin-left 10px; position:absolute; top:5px; right:5px;"),s.innerHTML="&#10006;",s.addEventListener("click",function(e){e.preventDefault(),d.progCont.removeChild(i)}),a.appendChild(l),a.appendChild(s);var p=document.createElement("div");p.setAttribute("style","height:2px; width:90%; background-color:yellow; margin:5px 0px;");var c=document.createElement("div"),u=document.createElement("a");u.setAttribute("style","text-decoration:none; margin-left 10px;"),u.innerHTML="uploading..";var f=document.createElement("a");f.setAttribute("style","text-decoration:none; margin-left 10px;"),f.innerHTML="0%",c.appendChild(u),c.appendChild(f),i.appendChild(a),i.appendChild(p),i.appendChild(c);var m={};return m.thisUplod=i,m.progHndlr=p,m.percentHndlr=f,m.statusHndlr=u,d.progCont.appendChild(i),m}function r(e,t){var n=e.loaded/e.total*100;t.percentHndlr.innerHTML=Math.round(n)+"%",t.progHndlr.style.width=Math.round(n)+"%"}function o(e,t){t.progHndlr.style["background-color"]="#40FF00",t.statusHndlr.innerHTML='<font color="#40FF00">Upload complete. </font>',d.uploadSuccess(e.target.response)}function i(e,t){t.progHndlr.style["background-color"]="red",t.statusHndlr.innerHTML='<font color="red">Failed! </font>'}function a(e,t){t.progHndlr.style["background-color"]="red",t.statusHndlr.innerHTML='<font color="red">Aborted! </font>'}for(var d=this,l=0;l<e.length;l++){var s=e[l];if(s.type.match("image")){var p=new FileReader;p.onload=function(e){return function(n){t(n,e)}}(s),p.readAsDataURL(s),d.filelist.push(s)}}};